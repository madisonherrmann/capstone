---
title: 'Developing a "Smart" Recovery Monitoring and Support System'
author: "Madison Herrmann & Tianrun Zhu"
institute: "University of Wisconsin-Madison"
date: December 13, 2024
format: 
  revealjs:
    scrollable: true
    css: chm.css
    slide-number: false 
title-slide-attributes:
  data-background-image:  https://github.com/jjcurtin/lectures/blob/main/images/smartphone_know_you.png?raw=true
  data-background-size: 20%
  data-background-repeat: no
  data-background-position: left 10% bottom 10%
include-after: |
  <script type="text/javascript">
    Reveal.on('ready', event => {
      if (event.indexh === 0) {
        document.querySelector("div.has-logo > img.slide-logo").style.display = "block";
        document.querySelector("div.has-logo > img.slide-logo").style.display = "block";
        document.querySelector("div.has-logo > img.slide-logo").style.display = "none";
        Reveal.configure({ slideNumber: null });
        Reveal.configure({ slideNumber: 'c' });
editor_options: 
  chunk_output_type: console
---

```{r}
#| echo: false
#| message: false
#| warning: false

library(skimr)
library(tidyverse) 
library(knitr)
library(kableExtra, exclude = c("group_rows"))
#devtools::source_url("https://github.com/jjcurtin/lab_support/blob/main/fun_eda.R?raw=true")
#devtools::source_url("https://github.com/jjcurtin/lab_support/blob/main/format_path.R?raw=true")
#devtools::source_url("https://github.com/jjcurtin/lab_support/blob/main/fun_plots.R?raw=true")
theme_set(theme_classic())
options(dplyr.print_max=Inf)

#path_processed_opt <- format_path("studydata/optimize/data_processed")
#path_processed <- format_path("studydata/risk2/data_processed/shared")
```

```{r}
#| message: false
#| warning: false

# Read in data
#intake <- read_csv(here::here(path_processed, "survey_intake_wide.csv"))
#ema <- read_rds(here::here(path_processed_opt, "ema_1day_shapley_labels.rds"))
```

## Alcohol Use Disorder and Opioid Use Disorder

-   Chronic

-   Barriers to treatment
    -   Accessibility
    -   Affordability
    -   Stigmatization

:::{.notes}
Alcohol and Opioid use disorders are chronic, requiring lifelong management, however there are many barriers to accessing continued care in the United States, like affordability. Stigmatization of substance use disorders creates an even bigger challenge for individuals to receive initial access to treatment.
:::

## Recovery is dynamic

- Important risk factors differ across people and time

\

- How can we provide the **right interventions and supports** to the **right people** at the **right time**, **every time**?

\

- Need for continuous monitoring

:::{.notes}
Recovery is dynamic in nature as important risk factors at one moment might not be the same across time. That is, interventions that support early recovery might differ from what is needed later. For example, craving might be the most important feature impacting lapse probability in early recovery, requiring interventions like urge-surfing. Over-time, the importance of craving will likely decrease, given the individual is engaging with the interventions. However, the same individual could have a stressful event that increases lapse probability and requires a different intervention, like attending an AA meeting. Hence, the factors contributing to lapse risk require continuous monitoring to deploy the necessary intervention, for that individual, at that particular moment in time.
:::

## Overarching Goal

-   Implement a temporally-precise, risk-monitoring system

\

-   Improve clinical outcomes

\

-   Mitigate barriers in accessibility
    
:::{.notes}
Our aim is to implement a risk-monitoring system that can deliver real-time interventions and improve clinical outcomes, while mitigating barriers in accessibility. 
:::

## Monitoring Lapse Risk 

- Active Sensing
  - Ecological Momentary Assessment

- Passive Sensing
  - Geolocation
  - Cellular Communications 
  
:::{.notes} 
Lapse risk is monitored through active and passive sensing. Ecological momentary assessments refer to daily self-report measures that assess mood, experiences, and past use. Through passive sensing methods, geolocation and cellular communication data was also collected. These methods were used over the course of three months with the aim of predicting lapse probability in individuals' recovering from alcohol use disorder.
:::

## AUD Characteristics

::: {.columns}
:::: {.column width="50%"}
- 151 individuals with moderate to severe AUD

\

- Early in recovery (1-8 weeks)

\

- Committed to abstinence throughout study
::::

:::: {.column width="50%"}
![](dsm.png)
::::
:::

:::{.notes} 
Data was collected on 151 individuals with moderate to severe AUD in early stages of recovery. The majority of participants reported over 10 symptoms of AUD.
:::

## AUD Characteristics

![](aud_demographics.png)


:::{.notes}
We had reasonable diversity across many characteristics including age, sex at birth, marital status, education, and income. However, given the recruiting methods, there is very little racial and ethnic diversity in the sample. The sample is predominately white and non-Hispanic.
::: 

## Predicting Lapse in AUD

::: {.columns}
:::: {.column width="50%"}
- Model trained with EMA achieved an outstanding AUC of 0.91

\

- How do we implement model for clinical benefit? 
  - Retrain model with geolocation and EMA
  - Key step towards real-time risk-prediction system
::::

:::: {.column width="50%"}
![](dsm.png) **replace w/ au_roc plot**
::::
:::

:::{.notes}
A previous model based solely on self-report measures predicted next-day lapse and achieved an outstanding AUC of 0.91, far surpassing industry benchmarks. Now that we have this model, how can we implement it for clinical benefit? My updated model is a key step toward deploying real-time risk-prediction systems, improving access to continuous care in this chronic disorder. To do this, I retrained the model with both EMA and geo-location to predict the probability of lapse risk in individuals recovering from alcohol use disorder. The addition of geo-location provides information on risky locations and people, increasing temporal precision. The model was trained using high throughput computing with algorithm and resulted in an AUC of ....
:::

## Important Features

- Globally Important
  - Past use
  - Future Efficacy
  - Craving

- Local Importance: SHAPs
  -   Negative values represent EMA items that decrease the probability of lapse.
  -   Positive values indicate an increased probability. 

:::{.notes} 
Across participants, past use, future efficacy, and craving were the most important predictors of lapse. However, different risk factors effect differnt people at different times. Shap values reveal which EMA items change lapse probability. Negative values decrease lapse probability, while positive values increase it.  Lets look at the most important features for a specific particpant across the study.
:::

## Local importance

![](past_stress.png)

:::{.notes}
Past use is initially their most important feature contributing to an increase in lapse probability. After day 10, future efficacy is briefly the most important feature before shifting back to past use. By day 40, it appears craving is now driving lapse probability the most, until around day 60. The other features are mostly static across 0, indicating little impact on lapse probability for this individual. Now let's compare to another subject. 
:::

## Local Importance

![](subid_190.png)


:::{.notes}
This participant did not lapse across the study, as past use consistently lowered lapse probability. Initially the most important feature increasing lapse probability is past stressful event, but it's quickly replaced by craving. Around day 10 future efficacy is increasing lapse risk the most, but drops off around day 25 when past pleasant event surpasses it. Future efficacy appears to have the biggest effect on lapse risk, given the variation. Across time, arousal, past stressful event, craving, future efficacy, and past pleasant event were the most important features influencing lapse risk for this participant. The difference in risk factors over time emphasizes the need for tailor-made, temporally-precise interventions that support continuous recovery.
::: 

## OUD Characteristics

## Predicting Lapse in OUD

## Future Directions

- Measuring trust, engagement, usability of risk-monitoring system interventions
- Determining how models can be clinically useful 
