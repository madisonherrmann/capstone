---
title: 'Machine Learning in Digital Mental Health Interventions'
author: "Madison Herrmann & Tianrun Zhu"
institute: "University of Wisconsin-Madison"
date: December 13, 2024
format: 
  revealjs:
    chalkboard: true
    scrollable: true
    css: slides.css
    slide-number: false 
title-slide-attributes:
  data-background-image: https://github.com/jjcurtin/lectures/blob/main/images/smartphone_know_you.png?raw=true
  data-background-size: 25%
  data-background-repeat: no
  data-background-position: left 10% bottom 10%
include-after: |
  <style>
    /* Apply custom styles only to the title slide */
    }
    }
    }
    }
    }
    });
    .reveal .slides > section:first-of-type h1 {
      color: blue;         /* Title color */
      font-size: 4rem;     /* Larger font size */
      text-align: center;  /* Center align the title */
      font-weight: bold;   /* Bold text */
    .reveal .slides > section:first-of-type h2 {
      font-size: 1.5rem;   /* Smaller font for author */
      text-align: center;  /* Center align the author */
    .reveal .slides > section:first-of-type h3 {
      font-size: 1.2rem;   /* Smaller font for institute */
      text-align: center;  /* Center align the institute */
    .reveal .slides > section:first-of-type h4 {
      font-size: 1rem;     /* Small font for date */
      text-align: center;  /* Center align the date */
    .reveal .slides > section:first-of-type {
      }
      padding-top: 2rem;   /* Adds space at the top */
  <script type="text/javascript">
    Reveal.on('ready', event => {
      if (event.indexh === 0) {
        document.querySelector("div.has-logo > img.slide-logo").style.display = "block";
        document.querySelector("div.has-logo > img.slide-logo").style.display = "none";
        Reveal.configure({ slideNumber: null });
        Reveal.configure({ slideNumber: 'c' });
editor_options: 
  chunk_output_type: console
---

```{r}
#| echo: false
#| message: false
#| warning: false

library(skimr)
library(tidyverse) 
library(knitr)
library(kableExtra, exclude = c("group_rows"))
theme_set(theme_classic())
options(dplyr.print_max=Inf)
```



## <span style="color: green; text-decoration: underline;">Substance Use Disorders</span>

-   Barriers to treatment
    -   [Accessibility]{style="color: gray;"}
    -   [Affordability]{style="color: gray;"}
    -   [Availability]{style="color: gray;"}
    -   [Acceptability]{style="color: gray;"}

:::{notes}
notes
:::


## <span style="color: green; text-decoration: underline;">ARC</span>

## <span style="color: green; text-decoration: underline;">Overarching Goal</span>

**TIANRUN U CAN CHANGE THE BULLETS BUT KEEP THE NIH AND PUT IT SOMEWHERE**
::: {.columns}
:::: {.column width="60%"}
-   Implement a temporally-precise, risk-monitoring system

\

-   Mitigate barriers in accessibility

\

-   Deliver tailored support and recommendations
::::

:::: {.column width="40%"}
![](nih.png)
::::
:::

## <span style="color: green; text-decoration: underline;">Define Lapse</span>

## <span style="color: green; text-decoration: underline;">Predicting Lapse with EMA</span>

**TIANRUN MAKE THIS ONLY AB EMA, KEEP PIC**
::: {.columns}
:::: {.column width="30%"}
- [Active Sensing]{style="color: blue;"}
  - Ecological Momentary Assessment (**EMA**)

- [Passive Sensing]{style="color: blue;"}
  - Geolocation
  - Cellular Communications 
::::

:::: {.column width="70%"}
![](aud_ema.png)
::::
:::

## <span style="color: green; text-decoration: underline;">OUD Characteristics</span>




## <span style="color: green; text-decoration: underline;">Predicting Lapse in OUD</span>





## <span style="color: green; text-decoration: underline;">Models</span>





## <span style="color: green; text-decoration: underline;">Models</span>






## <span style="color: green; text-decoration: underline;">Model Implementation</span>


- How might we use these models to deploy the **right** recommendation, to the **right person**, at the **right time**? 

\

- Retrain model with [geolocation]{style="color: blue;"} and [EMA]{style="color: blue;"}
  - Passive sensing
  - Continuous monitoring
  

:::{.notes}
Now that we can successfully predict lapse probability, How might we use these models to deploy the right recommendation, at the right time, to the right person? Through the addition of geolocation features, we can gain insight into not only when an individual is at a higher risk of lapsing, but why. Geolocation is a form of passive sensing that can provide context into the places and situations impacting lapse risk using GPS tracking.    
:::

## <span style="color: green; text-decoration: underline;">Geolocation</span>

![](aud_gps.jpg)

:::{.notes}
 Here is an example of some the survey questions asked regarding geolocation. Participants reported frequently visited locations and were asked various questions regarding previous use, alcohol availability, and valence. Using data from our alcohol use disorder sample, we can begin to understand the need for continuous monitoring in recovery
:::

## <span style="color: green; text-decoration: underline;">AUD Characteristics</span>

::: {.columns}
:::: {.column width="50%"}
- 151 individuals with moderate to severe AUD

\

- Early in recovery (1-8 weeks)

\

- Committed to abstinence throughout study
::::

:::: {.column width="50%"}
![](aud_dsm.png)
::::
:::

:::{.notes} 
To start, lets characterize our sample. Data was collected on 151 individuals with moderate to severe AUD in the early stages of recovery. The majority of participants reported over 10 symptoms and committed to abstinence for the duration of the study.
:::

## <span style="color: green; text-decoration: underline;">AUD Characteristics</span>

![](aud_demographics.png)


:::{.notes}
We had reasonable diversity across many characteristics including age, sex at birth, marital status, education, and income. However, given the recruiting methods, there is very little racial and ethnic diversity in the sample. Now that we have some background on the sample, we can pivot to the modeling process. 
::: 



## <span style="color: green; text-decoration: underline;">Area under ROC Curve (auROC)</span>

![](aud_auroc_v4.png) 

:::{.notes}
I retrained the model using 1x daily EMA with geolocation and day level windows. High throughput computing was utilized along with the XGBOOST algorithm and 5 by 10 kfold cross validation. The best configuration resulted in a median auroc of .85. The drop in performance is likely due to using 24-hr periods instead of hour-by-hour windows to predict lapse probability. Despite the drop in performance, additional geolocation improved the models contextual awareness, a key step that brings us closer to deploying a real-time risk monitoring and support system. Lets now look at what features were the most important for the model's predictions.
:::

## <span style="color: green; text-decoration: underline;">Global Importance</span>


![](aud_global_importance.png) 


:::{.notes} 
Global importance reveals which risk features were the most important for predicting lapse probability across participants. Past use and future efficacy, both from the EMAs,  were by far the most important predictors of lapse. Past use refers to reported drinking days since their last EMA. Future efficacy measures how likely individuals are to drink in the near future. In regards to the geolocation features, risky location was the most important. This asked particpants to report if a location puts them at any risk to begin drinking. Others include: alcohol availability at location, type of location, and location valence. Lets look at how these features can predict lapse probability. 
:::

## <span style="color: green; text-decoration: underline;">Important Risk Features</span>

![](aud_past_use.png) 

:::{.notes}
Drawing your attention to the y-axis, observations below zero are decreasing lapse probability, while observations above zero are increasing it. Observations below zero reflect reports of no past use, bringing down lapse probability. There is a mostly linear relationship with past use and an increased risk of lapse. That is, high reports of past use are associated with an increased risk of lapse. Hence, if someone reported past use the day prior, their lapse probability for the next-day is likely to be higher.
:::

## <span style="color: green; text-decoration: underline;">Important Risk Features</span>

![](aud_future_efficacy.png) 

:::{.notes}
Future efficacy asked participants how likely are you to drink within the next week, on a scale from 1-10? On average, reports of high likelihood were associated with a higher probability of lapsing.
:::

## <span style="color: green; text-decoration: underline;">Important Risk Features</span>

![](aud_past_use.png) 

:::{.notes}
GPS Feature will go above was interpretation from Kendra is approved. Now that we have a sense of how these features can predict lapse risk, let's see how they vary across individuals and time.
:::

## <span style="color: green; text-decoration: underline;">Local Importance</span>

- [Shapley Values]{style="color: blue;"}

  -   Negative values decrease lapse probability.
    - Act as **protective features**
  
  \
  
  -   Positive values increase lapse risk probability.
    - Act as **risk features**

:::{.notes}
SHAP values are an explanatory approach providing insight into the relative risk factors for an individual. This allows us to determine which features on which days impact lapse risk for each participant. Negative values indicate a decreased risk of lapse, or protective features. while positive values represent an increased lapse probability, or risk feature. Lets look at the most important features for a specific participant across the study.
:::

## <span style="color: green; text-decoration: underline;">Local Importance</span>


![](aud_risk_loc.png)

:::{.notes}
In the beginning, This participant had little change in their risk features, with past use and future efficacy bringing down their probability of lapse. The other features are staying constant at zero, indicating little to no influence on lapse risk. However, around day 35, past use, the blue line, drives up their lapse risk considerably. This increase coincides with the slight increase in time spent at a risky location, as shown with the purple line. This geolocation feature provides insights into why this individual may have lapsed, as they most likely went to a bar. Moreover, future efficacy, the yellow-green line, lags behind past use. This makes sense as a person who is currently using is likely to feel less confident about future abstinence. Around day 50, a future risky situation decreases their lapse risk, acting as a protective feature at certain points. This participant likely reported low likelihood of a future risky situation. The variability of this plot highlights that at any given day, the most important feature impacting lapse risk can change.
:::

## <span style="color: green; text-decoration: underline;">Local Importance</span>


![](aud_loc_valence.png)

:::{.notes}
For this participant, past use acts as their most important protective feature, differing from the previous example. This is shown by the blue line bringing down their lapse risk, indicating someone who did not lapse on study. The green line increasing their risk of lapse is location valence. This refers to the emotions associated with a particular place. Future efficacy acts as a protective feature  until around day 65, when it jumps above location valence. This indicates the participant reported a higher likelihood of drinking, relative to their previous self-reports. Their lack of confidence in future abstinence increases their probability of lapsing. There is a vast difference between this participant's relative risk features and the previous. For this participant, past use acts as their most important protective feature, consistently lowering their risk of lapse. As opposed to the previous plot, where past use acted as the most important risk factor, increasing the probability of lapse. This highlights the need for personalized recommendations and supports as different risk features can impact lapse risk in different ways, for different people. The ability to use these features to deliver tailored interventions that support recovery is the first step towards clinical implementation. 
:::

## <span style="color: green; text-decoration: underline;">Future Directions</span>


- Writing [recommendations]{style="color: blue;"} based on important features

\

- Measuring [trust]{style="color: blue;"}, [engagement]{style="color: blue;"}, and [usability]{style="color: blue;"} of risk-monitoring system interventions

\

- Determining how models can be [clinically useful]{style="color: blue;"} 


:::{.notes}
Now that we know the most important features impacting lapse probability, we can begin to develop support recommendations for model implementation. Once the system is implemented, we will provide users with tailored recommendations based on their current risk features. Our team is actively exploring the optimal methods for delivering these recommendations, including the language, tone, and format, to minimize participant burden. We are working to develop reliable approaches that measure the system's trust, engagement, and usability. In doing so, we hope to see that engaging with support messages acts as a protective factor in recovery. 
:::

## <span style="color: green; text-decoration: underline;">Credits</span>

- **PI:** John Curtin, PhD
- **Lab Manager:** Susan Wanta
- **PhD Mentor:** Kendra Wyant
- **OUD Demographics:** Zihan Li

